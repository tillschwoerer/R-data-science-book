<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Categorical data: forcats | R Data Science Book</title>
  <meta name="description" content="6 Categorical data: forcats | R Data Science Book" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Categorical data: forcats | R Data Science Book" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="tillschwoerer/R-data-science-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Categorical data: forcats | R Data Science Book" />
  
  
  

<meta name="author" content="Tools and Programming Languages for Data Scientists, FH Kiel, Summer Term 2020" />


<meta name="date" content="2020-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lubridate.html"/>
<link rel="next" href="stringr.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goals"><i class="fa fa-check"></i><b>1.1</b> Goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#git-and-github"><i class="fa fa-check"></i><b>1.3</b> Git and GitHub</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>2</b> Reading data: readr</a></li>
<li class="chapter" data-level="3" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>3</b> Tidying data: tidyr</a></li>
<li class="chapter" data-level="4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4</b> Wrangling data: dplyr</a><ul>
<li class="chapter" data-level="4.1" data-path="dplyr.html"><a href="dplyr.html#typical-workflows"><i class="fa fa-check"></i><b>4.1</b> Two typial workflows</a></li>
<li class="chapter" data-level="4.2" data-path="dplyr.html"><a href="dplyr.html#manipulating-rows"><i class="fa fa-check"></i><b>4.2</b> Manipulating rows</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dplyr.html"><a href="dplyr.html#extract-rows"><i class="fa fa-check"></i><b>4.2.1</b> Extract rows</a></li>
<li class="chapter" data-level="4.2.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>4.2.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dplyr.html"><a href="dplyr.html#manipulating-columns"><i class="fa fa-check"></i><b>4.3</b> Manipulating columns</a><ul>
<li class="chapter" data-level="4.3.1" data-path="dplyr.html"><a href="dplyr.html#extract-and-rename-columns"><i class="fa fa-check"></i><b>4.3.1</b> Extract and rename columns</a></li>
<li class="chapter" data-level="4.3.2" data-path="dplyr.html"><a href="dplyr.html#create-new-columns"><i class="fa fa-check"></i><b>4.3.2</b> Create new columns</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html#scoped-functions"><i class="fa fa-check"></i><b>4.4</b> Scoped functions</a></li>
<li class="chapter" data-level="4.5" data-path="dplyr.html"><a href="dplyr.html#aggregate"><i class="fa fa-check"></i><b>4.5</b> Aggregate</a></li>
<li class="chapter" data-level="4.6" data-path="dplyr.html"><a href="dplyr.html#window-functions"><i class="fa fa-check"></i><b>4.6</b> Window functions</a></li>
<li class="chapter" data-level="4.7" data-path="dplyr.html"><a href="dplyr.html#combining-tables"><i class="fa fa-check"></i><b>4.7</b> Combining tables</a></li>
<li class="chapter" data-level="4.8" data-path="dplyr.html"><a href="dplyr.html#database-backend"><i class="fa fa-check"></i><b>4.8</b> Database backend</a><ul>
<li class="chapter" data-level="4.8.1" data-path="dplyr.html"><a href="dplyr.html#motivation"><i class="fa fa-check"></i><b>4.8.1</b> Motivation</a></li>
<li class="chapter" data-level="4.8.2" data-path="dplyr.html"><a href="dplyr.html#set-up"><i class="fa fa-check"></i><b>4.8.2</b> Set up</a></li>
<li class="chapter" data-level="4.8.3" data-path="dplyr.html"><a href="dplyr.html#querying-the-database"><i class="fa fa-check"></i><b>4.8.3</b> Querying the database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lubridate.html"><a href="lubridate.html"><i class="fa fa-check"></i><b>5</b> Dates and times: lubridate</a><ul>
<li class="chapter" data-level="5.1" data-path="lubridate.html"><a href="lubridate.html#what-is-lubridate"><i class="fa fa-check"></i><b>5.1</b> What is Lubridate?</a></li>
<li class="chapter" data-level="5.2" data-path="lubridate.html"><a href="lubridate.html#basics"><i class="fa fa-check"></i><b>5.2</b> Basics</a></li>
<li class="chapter" data-level="5.3" data-path="lubridate.html"><a href="lubridate.html#import-data-clean-date-time"><i class="fa fa-check"></i><b>5.3</b> Import data, clean date-time</a></li>
<li class="chapter" data-level="5.4" data-path="lubridate.html"><a href="lubridate.html#check-and-modify-data"><i class="fa fa-check"></i><b>5.4</b> Check and modify data</a></li>
<li class="chapter" data-level="5.5" data-path="lubridate.html"><a href="lubridate.html#before-exploration"><i class="fa fa-check"></i><b>5.5</b> Before exploration</a><ul>
<li class="chapter" data-level="5.5.1" data-path="lubridate.html"><a href="lubridate.html#intervals"><i class="fa fa-check"></i><b>5.5.1</b> Intervals</a></li>
<li class="chapter" data-level="5.5.2" data-path="lubridate.html"><a href="lubridate.html#groupings"><i class="fa fa-check"></i><b>5.5.2</b> Groupings</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lubridate.html"><a href="lubridate.html#exploration---analysis"><i class="fa fa-check"></i><b>5.6</b> Exploration - Analysis</a><ul>
<li class="chapter" data-level="5.6.1" data-path="lubridate.html"><a href="lubridate.html#temperatur"><i class="fa fa-check"></i><b>5.6.1</b> Temperatur</a></li>
<li class="chapter" data-level="5.6.2" data-path="lubridate.html"><a href="lubridate.html#rainfall"><i class="fa fa-check"></i><b>5.6.2</b> Rainfall</a></li>
<li class="chapter" data-level="5.6.3" data-path="lubridate.html"><a href="lubridate.html#humidity"><i class="fa fa-check"></i><b>5.6.3</b> Humidity</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lubridate.html"><a href="lubridate.html#wrap-up"><i class="fa fa-check"></i><b>5.7</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="forcats.html"><a href="forcats.html"><i class="fa fa-check"></i><b>6</b> Categorical data: forcats</a><ul>
<li class="chapter" data-level="6.1" data-path="forcats.html"><a href="forcats.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="forcats.html"><a href="forcats.html#general-functions"><i class="fa fa-check"></i><b>6.2</b> General functions</a><ul>
<li class="chapter" data-level="6.2.1" data-path="forcats.html"><a href="forcats.html#create"><i class="fa fa-check"></i><b>6.2.1</b> Create</a></li>
<li class="chapter" data-level="6.2.2" data-path="forcats.html"><a href="forcats.html#count-values-per-level"><i class="fa fa-check"></i><b>6.2.2</b> Count values per level</a></li>
<li class="chapter" data-level="6.2.3" data-path="forcats.html"><a href="forcats.html#Inspect-and-set-levels"><i class="fa fa-check"></i><b>6.2.3</b> Inspect and set levels</a></li>
<li class="chapter" data-level="6.2.4" data-path="forcats.html"><a href="forcats.html#inspect-unique-values"><i class="fa fa-check"></i><b>6.2.4</b> Inspect unique values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="forcats.html"><a href="forcats.html#combine-factors"><i class="fa fa-check"></i><b>6.3</b> Combine factors</a><ul>
<li class="chapter" data-level="6.3.1" data-path="forcats.html"><a href="forcats.html#combine-factors-with-different-levels"><i class="fa fa-check"></i><b>6.3.1</b> Combine factors with different levels</a></li>
<li class="chapter" data-level="6.3.2" data-path="forcats.html"><a href="forcats.html#standardise-levels-of-various-factors"><i class="fa fa-check"></i><b>6.3.2</b> Standardise levels of various factors</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="forcats.html"><a href="forcats.html#order-of-levels"><i class="fa fa-check"></i><b>6.4</b> Order of levels</a><ul>
<li class="chapter" data-level="6.4.1" data-path="forcats.html"><a href="forcats.html#manual-reordering"><i class="fa fa-check"></i><b>6.4.1</b> Manual reordering of levels</a></li>
<li class="chapter" data-level="6.4.2" data-path="forcats.html"><a href="forcats.html#reordering-by-frequency"><i class="fa fa-check"></i><b>6.4.2</b> Reordering by frequency</a></li>
<li class="chapter" data-level="6.4.3" data-path="forcats.html"><a href="forcats.html#reordering-by-appearance"><i class="fa fa-check"></i><b>6.4.3</b> Reordering by appearance</a></li>
<li class="chapter" data-level="6.4.4" data-path="forcats.html"><a href="forcats.html#reverse-level-order"><i class="fa fa-check"></i><b>6.4.4</b> Reverse level order</a></li>
<li class="chapter" data-level="6.4.5" data-path="forcats.html"><a href="forcats.html#shift-levels"><i class="fa fa-check"></i><b>6.4.5</b> Shift levels</a></li>
<li class="chapter" data-level="6.4.6" data-path="forcats.html"><a href="forcats.html#randomly-shuffle-levels"><i class="fa fa-check"></i><b>6.4.6</b> Randomly shuffle levels</a></li>
<li class="chapter" data-level="6.4.7" data-path="forcats.html"><a href="forcats.html#reordering-levels-by-other-variables"><i class="fa fa-check"></i><b>6.4.7</b> Reordering levels by other variables</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="forcats.html"><a href="forcats.html#change-the-value-of-levels"><i class="fa fa-check"></i><b>6.5</b> Change the value of levels</a><ul>
<li class="chapter" data-level="6.5.1" data-path="forcats.html"><a href="forcats.html#renaming-the-levels"><i class="fa fa-check"></i><b>6.5.1</b> Renaming the levels</a></li>
<li class="chapter" data-level="6.5.2" data-path="forcats.html"><a href="forcats.html#anonymize-levels"><i class="fa fa-check"></i><b>6.5.2</b> Anonymize levels</a></li>
<li class="chapter" data-level="6.5.3" data-path="forcats.html"><a href="forcats.html#collapse-multiple-levels-into-one"><i class="fa fa-check"></i><b>6.5.3</b> Collapse multiple levels into one</a></li>
<li class="chapter" data-level="6.5.4" data-path="forcats.html"><a href="forcats.html#aggregate-levels-into-a-lump"><i class="fa fa-check"></i><b>6.5.4</b> Aggregate levels into a lump</a></li>
<li class="chapter" data-level="6.5.5" data-path="forcats.html"><a href="forcats.html#manually-lump-levels"><i class="fa fa-check"></i><b>6.5.5</b> Manually lump levels</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="forcats.html"><a href="forcats.html#add-or-drop-levels"><i class="fa fa-check"></i><b>6.6</b> Add or drop levels</a><ul>
<li class="chapter" data-level="6.6.1" data-path="forcats.html"><a href="forcats.html#add-levels"><i class="fa fa-check"></i><b>6.6.1</b> Add levels</a></li>
<li class="chapter" data-level="6.6.2" data-path="forcats.html"><a href="forcats.html#drop-levels"><i class="fa fa-check"></i><b>6.6.2</b> Drop levels</a></li>
<li class="chapter" data-level="6.6.3" data-path="forcats.html"><a href="forcats.html#assign-a-level-to-nas"><i class="fa fa-check"></i><b>6.6.3</b> Assign a level to <code>NAs</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>7</b> Character data: stringr</a><ul>
<li class="chapter" data-level="7.1" data-path="stringr.html"><a href="stringr.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="7.1.1" data-path="stringr.html"><a href="stringr.html#use-of-stringr-in-the-r-environment"><i class="fa fa-check"></i><b>7.1.1</b> Use of stringR in the R environment</a></li>
<li class="chapter" data-level="7.1.2" data-path="stringr.html"><a href="stringr.html#types-of-data-which-could-be-used-with-stringr"><i class="fa fa-check"></i><b>7.1.2</b> Types of data, which could be used with stringR</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="stringr.html"><a href="stringr.html#data-set-for-examples"><i class="fa fa-check"></i><b>7.2</b> Data Set for examples</a></li>
<li class="chapter" data-level="7.3" data-path="stringr.html"><a href="stringr.html#regular-expressions"><i class="fa fa-check"></i><b>7.3</b> Regular Expressions</a></li>
<li class="chapter" data-level="7.4" data-path="stringr.html"><a href="stringr.html#functions-of-stringr-explained"><i class="fa fa-check"></i><b>7.4</b> Functions of stringR explained</a><ul>
<li class="chapter" data-level="7.4.1" data-path="stringr.html"><a href="stringr.html#manage-lengths"><i class="fa fa-check"></i><b>7.4.1</b> Manage lengths</a></li>
<li class="chapter" data-level="7.4.2" data-path="stringr.html"><a href="stringr.html#subset-strings"><i class="fa fa-check"></i><b>7.4.2</b> Subset Strings</a></li>
<li class="chapter" data-level="7.4.3" data-path="stringr.html"><a href="stringr.html#detect-matches"><i class="fa fa-check"></i><b>7.4.3</b> Detect matches</a></li>
<li class="chapter" data-level="7.4.4" data-path="stringr.html"><a href="stringr.html#mutate-strings"><i class="fa fa-check"></i><b>7.4.4</b> Mutate Strings</a></li>
<li class="chapter" data-level="7.4.5" data-path="stringr.html"><a href="stringr.html#join-and-split"><i class="fa fa-check"></i><b>7.4.5</b> Join and Split</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stringr.html"><a href="stringr.html#literature"><i class="fa fa-check"></i><b>7.5</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-table.html"><a href="data-table.html"><i class="fa fa-check"></i><b>8</b> High performance computing: data.table</a><ul>
<li class="chapter" data-level="8.1" data-path="data-table.html"><a href="data-table.html#motivation-1"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
<li class="chapter" data-level="8.2" data-path="data-table.html"><a href="data-table.html#data-exploration"><i class="fa fa-check"></i><b>8.2</b> Data exploration</a><ul>
<li class="chapter" data-level="8.2.1" data-path="data-table.html"><a href="data-table.html#subsetting-rows"><i class="fa fa-check"></i><b>8.2.1</b> Subsetting rows</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-table.html"><a href="data-table.html#selecting-columns"><i class="fa fa-check"></i><b>8.2.2</b> Selecting Columns</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-table.html"><a href="data-table.html#grouping-results"><i class="fa fa-check"></i><b>8.2.3</b> Grouping results</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-table.html"><a href="data-table.html#editing-data"><i class="fa fa-check"></i><b>8.2.4</b> Editing Data</a></li>
<li class="chapter" data-level="8.2.5" data-path="data-table.html"><a href="data-table.html#side-effects"><i class="fa fa-check"></i><b>8.2.5</b> Side effects</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-table.html"><a href="data-table.html#runtime-comparision"><i class="fa fa-check"></i><b>8.3</b> Runtime comparision</a></li>
<li class="chapter" data-level="8.4" data-path="data-table.html"><a href="data-table.html#further-resources"><i class="fa fa-check"></i><b>8.4</b> Further resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Data Science Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="forcats" class="section level1">
<h1><span class="header-section-number">6</span> Categorical data: forcats</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>This chapter is dedicated to the handling of categorical variables. This becomes important if information is to be presented in a non-alphabetical order or aggregated in a meaningful way. Within the R programming language, categorical variables are converted into a form that can be used for analysis using factors. While many Base-R functions automatically convert character vectors into factors, tidyverse requires an explicit treatment. The core-tidyverse provides the package forcats, which will be described here. Further information and exercises are available at the sources shown.</p>
<p>Resources:</p>
<ul>
<li><a href="https://forcats.tidyverse.org/">Homepage</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/factors.pdf">Cheatsheet</a></li>
<li><a href="https://r4ds.had.co.nz/factors.html">Chapter in R4DS</a></li>
<li><a href="https://forcats.tidyverse.org/articles/forcats.html">Vignette</a></li>
</ul>
<p>In this chapter we use the demo data set <code>diamonds</code> from the ggplot2-package (<a href="https://ggplot2.tidyverse.org/reference/diamonds.html">more information</a>) as well as a dataset <code>olympic-games</code> which shows the medal success of olympic athletes from 1896 to 2016. For the latter we focus on the summer games 1896 and the winter games 1924 for practical reasons.<br />
Before you start reading, you should have read the chapter <strong><em>Wrangling Data: dplyr</em></strong> or be familiar with this field.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="co"># The package tidyverse contains all libraries necessary for this chapter.</span></a>
<a class="sourceLine" id="cb274-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb274-3" title="3"></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="co"># Importing the &quot;diamonds&quot; dataset.</span></a>
<a class="sourceLine" id="cb274-5" title="5">diamonds &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/diamonds.csv&quot;</span>)</a>
<a class="sourceLine" id="cb274-6" title="6"><span class="co"># Importing the &quot;olympic-games&quot; dataset.</span></a>
<a class="sourceLine" id="cb274-7" title="7">olympic &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/olympic-games.csv&quot;</span>)</a>
<a class="sourceLine" id="cb274-8" title="8"></a>
<a class="sourceLine" id="cb274-9" title="9"><span class="co"># Have a short look at the data.</span></a>
<a class="sourceLine" id="cb274-10" title="10"><span class="kw">head</span>(diamonds, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 10
##   carat cut     color clarity depth table price     x     y     z
##   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  0.23 Ideal   E     SI2      61.5    55   326  3.95  3.98  2.43
## 2  0.21 Premium E     SI1      59.8    61   326  3.89  3.84  2.31</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1"><span class="co"># Have a short look at the data.</span></a>
<a class="sourceLine" id="cb276-2" title="2"><span class="kw">head</span>(olympic, <span class="dv">2</span>)              </a></code></pre></div>
<pre><code>## # A tibble: 2 x 12
##   game  city  sport discipline athlete country age   height weight   bmi sex  
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
## 1 1992~ &lt;NA&gt;  Bask~ Basketbal~ A Diji~ China   24       180     80  24.7 M    
## 2 2012~ &lt;NA&gt;  Judo  Judo Men&#39;~ A Lamu~ China   23       170     60  20.8 M    
## # ... with 1 more variable: medal &lt;chr&gt;</code></pre>
</div>
<div id="general-functions" class="section level2">
<h2><span class="header-section-number">6.2</span> General functions</h2>
<div id="create" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Create</h3>
<p>Basically two things are needed to create a factor:</p>
<ol style="list-style-type: decimal">
<li>a vector which contains the <strong>values</strong> to be analyzed</li>
<li>another vector which divides the values into <strong>levels</strong></li>
</ol>
<p>As an example we will use the column <code>clarity</code> of the diamonds dataset.
It is a categorical evaluation of the clarity of a diamond and a subset of the grades according to the Gemological Institute of America (GIA) grading system. The grades according to GIA read as follows:</p>
<table>
<thead>
<tr class="header">
<th>GIA grade</th>
<th>Category</th>
<th align="center">Included in <code>diamonds</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FL</td>
<td>Flawless</td>
<td align="center"><font color="red">✘</font></td>
</tr>
<tr class="even">
<td>IF</td>
<td>Internally Flawless</td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="odd">
<td>VVS<sub>1</sub></td>
<td>Very Very Slightly Included<sub>1</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="even">
<td>VVS<sub>2</sub></td>
<td>Very Very Slightly Included<sub>2</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="odd">
<td>VS<sub>1</sub></td>
<td>Very Slightly Included<sub>1</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="even">
<td>VS<sub>2</sub></td>
<td>Very Slightly Included<sub>2</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="odd">
<td>SI<sub>1</sub></td>
<td>Slightly Included<sub>1</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="even">
<td>SI<sub>2</sub></td>
<td>Slightly Included<sub>2</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="odd">
<td>I<sub>1</sub></td>
<td>Included<sub>1</sub></td>
<td align="center"><font color="green">✔</font></td>
</tr>
<tr class="even">
<td>I<sub>2</sub></td>
<td>Included<sub>2</sub></td>
<td align="center"><font color="red">✘</font></td>
</tr>
<tr class="odd">
<td>I<sub>3</sub></td>
<td>Included<sub>3</sub></td>
<td align="center"><font color="red">✘</font></td>
</tr>
</tbody>
</table>
<p>If you are interested in the distribution of the diamonds in this category, you could do this by using a suitable query:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="co"># Count the number of observations per clarity grade and plot the result.</span></a>
<a class="sourceLine" id="cb278-2" title="2">diamonds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb278-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(clarity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb278-4" title="4"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb278-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> clarity)) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-6" title="6"><span class="st">  </span><span class="kw">geom_col</span>()</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>A sorting of the x-axis, which follows the order of the grades as shown in the table above, is unfortunately not possible in this form. A workaround is to convert the column <code>clarity</code> into a factor, which allows us to evaluate the individual categories. For this purpose we first define a vector, which ranks the categories according to their grade (from <em>bad</em> to <em>good</em>):</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1">levels_clarity &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;I1&quot;</span>, <span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;VS2&quot;</span>, <span class="st">&quot;VS1&quot;</span>, <span class="st">&quot;VVS2&quot;</span>, <span class="st">&quot;VVS1&quot;</span>, <span class="st">&quot;IF&quot;</span>)</a></code></pre></div>
<p>In the next step we lay this newly created levels vector on the column <code>clarity</code> of our data set to create a factor. The function <code>factor()</code> is a base-R function.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1">factor_clarity &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> diamonds<span class="op">$</span>clarity, <span class="dt">levels =</span> levels_clarity)</a></code></pre></div>
<p>The factor <code>factor_clarity</code> consists solely of the <code>clarity</code> column of the original <code>diamonds</code> data set.</p>
<p>Another possibility to create a factor is to convert a vector using <code>as_factor()</code>. Here the levels are created automatically. Their order however depends on the appearance of the corresponding value in the source vector.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="kw">as_factor</span>(diamonds<span class="op">$</span>clarity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb281-2" title="2"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;SI2&quot;  &quot;SI1&quot;  &quot;VS1&quot;  &quot;VS2&quot;  &quot;VVS2&quot; &quot;VVS1&quot; &quot;I1&quot;   &quot;IF&quot;</code></pre>
</div>
<div id="count-values-per-level" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Count values per level</h3>
<p>Now we repeat the analysis of the distribution within our dataset using the created factor with the levels in correct order. The function <code>fct_count()</code> returns the frequency of a categorical value within a factor. The order of the levels remains unchanged.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="kw">fct_count</span>(factor_clarity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb283-2" title="2"><span class="st">  </span><span class="co"># The definition of aesthetic mapping in this line is only used to label the axes.</span></a>
<a class="sourceLine" id="cb283-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> clarity)) <span class="op">+</span><span class="st">          </span></a>
<a class="sourceLine" id="cb283-4" title="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>It becomes obvious that the distribution can now be displayed in the desired order (by order of levels). Functions of the package forcats always start with the prefix <code>fct_</code>.</p>
</div>
<div id="Inspect-and-set-levels" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Inspect and set levels</h3>
<p>With the function <code>levels()</code> the levels of a factor can be both read and renamed. <strong>But be aware:</strong> this can only be used to change the names, not the order of the levels. The base-R function <code>unclass()</code> gives information about the internal memory structure of a factor.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="co"># Shows the original levels of our factor.</span></a>
<a class="sourceLine" id="cb284-2" title="2">factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-3" title="3"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;I1&quot;   &quot;SI2&quot;  &quot;SI1&quot;  &quot;VS2&quot;  &quot;VS1&quot;  &quot;VVS2&quot; &quot;VVS1&quot; &quot;IF&quot;</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="co"># Shows the internal structure.</span></a>
<a class="sourceLine" id="cb286-2" title="2">factor_clarity[<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="st">  </span><span class="kw">unclass</span>()               </a></code></pre></div>
<pre><code>##  [1] 2 3 5 4 2 6 7 3 4 5 3 5 3 2 2 1 2 3 3 3 2 4 5 3 3
## attr(,&quot;levels&quot;)
## [1] &quot;I1&quot;   &quot;SI2&quot;  &quot;SI1&quot;  &quot;VS2&quot;  &quot;VS1&quot;  &quot;VVS2&quot; &quot;VVS1&quot; &quot;IF&quot;</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1"><span class="co"># Keep the order of levels,</span></a>
<a class="sourceLine" id="cb288-2" title="2"><span class="co"># but replace the technical GIA jargon with something more understandable.</span></a>
<a class="sourceLine" id="cb288-3" title="3">levels_clarity_c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c8&quot;</span>, <span class="st">&quot;c7&quot;</span>, <span class="st">&quot;c6&quot;</span>, <span class="st">&quot;c5&quot;</span>, <span class="st">&quot;c4&quot;</span>, <span class="st">&quot;c3&quot;</span>, <span class="st">&quot;c2&quot;</span>, <span class="st">&quot;c1&quot;</span>)</a>
<a class="sourceLine" id="cb288-4" title="4"><span class="kw">levels</span>(factor_clarity) &lt;-<span class="st"> </span>levels_clarity_c</a>
<a class="sourceLine" id="cb288-5" title="5"></a>
<a class="sourceLine" id="cb288-6" title="6">factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb288-7" title="7"><span class="st">  </span><span class="kw">head</span>(<span class="dv">25</span>)</a></code></pre></div>
<pre><code>##  [1] c7 c6 c4 c5 c7 c3 c2 c6 c5 c4 c6 c4 c6 c7 c7 c8 c7 c6 c6 c6 c7 c5 c4 c6 c6
## Levels: c8 c7 c6 c5 c4 c3 c2 c1</code></pre>
</div>
<div id="inspect-unique-values" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Inspect unique values</h3>
<p>The function <code>fct_unique()</code> can be used to output unique values of a factor. In contrast to the base-R function <code>unique()</code> the values are returned in the order of the levels and not in the order of their appearance.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1">factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-2" title="2"><span class="st">  </span><span class="kw">fct_unique</span>()</a></code></pre></div>
<pre><code>## [1] c8 c7 c6 c5 c4 c3 c2 c1
## Levels: c8 c7 c6 c5 c4 c3 c2 c1</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1">factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-2" title="2"><span class="st">  </span><span class="kw">unique</span>()</a></code></pre></div>
<pre><code>## [1] c7 c6 c4 c5 c3 c2 c8 c1
## Levels: c8 c7 c6 c5 c4 c3 c2 c1</code></pre>
</div>
</div>
<div id="combine-factors" class="section level2">
<h2><span class="header-section-number">6.3</span> Combine factors</h2>
<div id="combine-factors-with-different-levels" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Combine factors with different levels</h3>
<p>With the function <code>fct_c()</code> factors with different levels can be combined to one factor covering all levels. First we create two factors. The first one shows the amount of contested disciplines by several countries during the Summer Olympic Games 1896. The second one shows the amount of contested disciplines by countries during the Winter Olympic Games 1924.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">olympic_<span class="dv">1896</span> &lt;-<span class="st"> </span>olympic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb294-2" title="2"><span class="st">  </span><span class="kw">filter</span>(game <span class="op">==</span><span class="st"> &quot;1896 Summer&quot;</span>)</a>
<a class="sourceLine" id="cb294-3" title="3"></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="co"># Create a factor using the default for the `levels` argument in `factor()`.</span></a>
<a class="sourceLine" id="cb294-5" title="5">countries_in_<span class="dv">1896</span> &lt;-<span class="st"> </span><span class="kw">factor</span>(olympic_<span class="dv">1896</span><span class="op">$</span>country)</a>
<a class="sourceLine" id="cb294-6" title="6"></a>
<a class="sourceLine" id="cb294-7" title="7">olympic_<span class="dv">1924</span> &lt;-<span class="st"> </span>olympic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb294-8" title="8"><span class="st">  </span><span class="kw">filter</span>(game <span class="op">==</span><span class="st"> &quot;1924 Winter&quot;</span>)</a>
<a class="sourceLine" id="cb294-9" title="9"></a>
<a class="sourceLine" id="cb294-10" title="10"><span class="co"># Create a factor using the default for the `levels` argument in `factor()`.</span></a>
<a class="sourceLine" id="cb294-11" title="11">countries_in_<span class="dv">1924</span> &lt;-<span class="st"> </span><span class="kw">factor</span>(olympic_<span class="dv">1924</span><span class="op">$</span>country)</a></code></pre></div>
<p>Note that the default option for the <code>levels</code> argument in <code>factor()</code> is a sorted set of the given values. As R sorts characters lexicographically, the corresponding levels are the countries sorted alphabetically <em>from A to Z</em>.
The factors differ both in their stored values and in their levels. A plot makes this clear:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-2" title="2"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country))<span class="op">+</span></a>
<a class="sourceLine" id="cb295-4" title="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">countries_in_<span class="dv">1924</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb296-2" title="2"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb296-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country))<span class="op">+</span></a>
<a class="sourceLine" id="cb296-4" title="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Now we combine the factors with <code>fct_c()</code> and plot it:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1"><span class="kw">fct_c</span>(countries_in_<span class="dv">1896</span>, countries_in_<span class="dv">1924</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb297-2" title="2"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb297-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country))<span class="op">+</span></a>
<a class="sourceLine" id="cb297-4" title="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Both the underlying values and the levels were combined into one factor.</p>
</div>
<div id="standardise-levels-of-various-factors" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Standardise levels of various factors</h3>
<p>With the function <code>fct_unify()</code> the levels of different factors can be standardised. The resulting output factors will retain their values, but all will have the same levels. Please note, both input and output are in list form.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">factor_list &lt;-<span class="st"> </span><span class="kw">fct_unify</span>(<span class="kw">list</span>(countries_in_<span class="dv">1896</span>, countries_in_<span class="dv">1924</span>))</a>
<a class="sourceLine" id="cb298-2" title="2"></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="co"># Plot the first output factor.</span></a>
<a class="sourceLine" id="cb298-4" title="4">factor_list[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-5" title="5"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-7" title="7"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="co"># Plot the second output factor.</span></a>
<a class="sourceLine" id="cb299-2" title="2">factor_list[[<span class="dv">2</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb299-3" title="3"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb299-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb299-5" title="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<p>In this case, the underlying values were left unchanged for both factors, but the levels were standardised. This is especially useful when comparing the values of two different factors.</p>
</div>
</div>
<div id="order-of-levels" class="section level2">
<h2><span class="header-section-number">6.4</span> Order of levels</h2>
<div id="manual-reordering" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Manual reordering of levels</h3>
<p>With the function <code>fct_relevel()</code> the levels of a factor can be manually reordered. In contrast, the function <code>levels()</code> only allows the renaming of factor levels. <code>fct_relevel()</code> also adjusts the order of the levels themselves by changing the way they are stored internally. An example should clarify this.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="co"># Have a look at the original levels.</span></a>
<a class="sourceLine" id="cb300-2" title="2">factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-3" title="3"><span class="st">  </span><span class="kw">fct_count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   f         n
##   &lt;fct&gt; &lt;int&gt;
## 1 c8      741
## 2 c7     9194
## 3 c6    13065
## 4 c5    12258
## 5 c4     8171
## 6 c3     5066
## 7 c2     3655
## 8 c1     1790</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="co"># Reorder levels according to `new_oder`.</span></a>
<a class="sourceLine" id="cb302-2" title="2">new_order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c1&quot;</span>,<span class="st">&quot;c3&quot;</span>,<span class="st">&quot;c5&quot;</span>,<span class="st">&quot;c7&quot;</span>,<span class="st">&quot;c2&quot;</span>,<span class="st">&quot;c4&quot;</span>,<span class="st">&quot;c6&quot;</span>,<span class="st">&quot;c8&quot;</span>)</a>
<a class="sourceLine" id="cb302-3" title="3"></a>
<a class="sourceLine" id="cb302-4" title="4">factor_clarity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb302-5" title="5"><span class="st">  </span><span class="kw">fct_relevel</span>(new_order) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb302-6" title="6"><span class="st">  </span><span class="kw">fct_count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   f         n
##   &lt;fct&gt; &lt;int&gt;
## 1 c1     1790
## 2 c3     5066
## 3 c5    12258
## 4 c7     9194
## 5 c2     3655
## 6 c4     8171
## 7 c6    13065
## 8 c8      741</code></pre>
<p>Keep in mind, only the function <code>fct_relevel()</code> allows a correct manual releveling. However, <code>levels()</code> only allows to change the levels’ names.</p>
</div>
<div id="reordering-by-frequency" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Reordering by frequency</h3>
<p>Especially for plots it is often useful to sort the order of the levels by the frequency of the corresponding values. The function <code>fct_infreq()</code> allows exactly this. Plotting the unsorted factor causes poor readability.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-2" title="2"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-4" title="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The better approach is to sort the data before plotting.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1"><span class="co"># Insert `fct_infreq()` to get the data ordered.</span></a>
<a class="sourceLine" id="cb305-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb305-3" title="3"><span class="st">  </span><span class="kw">fct_infreq</span>() <span class="op">%&gt;%</span><span class="st">    </span></a>
<a class="sourceLine" id="cb305-4" title="4"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb305-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="reordering-by-appearance" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Reordering by appearance</h3>
<p>The package forcats contains the function <code>fct_inorder()</code> which enables the sorting of levels by their order of appearance in the data set. To make this clear, we look at the first 20 entries of the data set:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">olympic_<span class="dv">1896</span><span class="op">$</span>country <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-2" title="2"><span class="st">  </span><span class="kw">head</span>(<span class="dv">20</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;Greece&quot;        &quot;Greece&quot;        &quot;Greece&quot;        &quot;Greece&quot;       
##  [5] &quot;Greece&quot;        &quot;Greece&quot;        &quot;Greece&quot;        &quot;Greece&quot;       
##  [9] &quot;Greece&quot;        &quot;Greece&quot;        &quot;Great Britain&quot; &quot;Great Britain&quot;
## [13] &quot;Great Britain&quot; &quot;Switzerland&quot;   &quot;Greece&quot;        &quot;United States&quot;
## [17] &quot;United States&quot; &quot;Germany&quot;       &quot;Germany&quot;       &quot;Germany&quot;</code></pre>
<p>Create a factor with levels in the order of the appearance shown above:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1">olympic_<span class="dv">1896</span><span class="op">$</span>country[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb308-2" title="2"><span class="st">  </span><span class="kw">fct_inorder</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb308-3" title="3"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Greece&quot;        &quot;Great Britain&quot; &quot;Switzerland&quot;   &quot;United States&quot;
## [5] &quot;Germany&quot;</code></pre>
<p>In this example the same result can be obtained using the function <code>as_factor()</code>. However, the function <code>fct_inorder()</code> can also be applied to already existing factors.</p>
</div>
<div id="reverse-level-order" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Reverse level order</h3>
<p>The function <code>fct_rev()</code> reverses the existing order of the levels of a factor. First, have a look at the original order:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="co"># Insert `fct_infreq()` to get the data ordered.</span></a>
<a class="sourceLine" id="cb310-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb310-3" title="3"><span class="st">  </span><span class="kw">fct_infreq</span>() <span class="op">%&gt;%</span><span class="st">        </span></a>
<a class="sourceLine" id="cb310-4" title="4"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb310-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-6" title="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Now we reverse the order:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1"><span class="co"># Insert `fct_infreq()` to get the data ordered.</span></a>
<a class="sourceLine" id="cb311-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-3" title="3"><span class="st">  </span><span class="kw">fct_infreq</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-4" title="4"><span class="co"># Insert `fct_rev()` to reverse this order.</span></a>
<a class="sourceLine" id="cb311-5" title="5"><span class="st">  </span><span class="kw">fct_rev</span>() <span class="op">%&gt;%</span><span class="st">           </span></a>
<a class="sourceLine" id="cb311-6" title="6"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-8" title="8"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="shift-levels" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Shift levels</h3>
<p>The argument <code>n</code> in the function <code>fct_shift()</code> allows to shift the levels to the left/right for negative/positive integer values of <code>n</code>, wrapping around end.
Thus, a value of <code>n = 1L</code> (<code>n = -1L</code>) would shift the order of the levels to the right (left) by one location.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="co"># Insert `fct_infreq()` to get the data ordered.</span></a>
<a class="sourceLine" id="cb312-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-3" title="3"><span class="st">  </span><span class="kw">fct_infreq</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-4" title="4"><span class="co"># Insert `fct_shift()` to shift levels.</span></a>
<a class="sourceLine" id="cb312-5" title="5"><span class="st">  </span><span class="kw">fct_shift</span>(<span class="dt">n =</span> <span class="op">-</span>1L) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb312-6" title="6"><span class="st">  </span><span class="kw">fct_count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">amount of disciplines</span><span class="st">`</span>, <span class="dt">y =</span> country)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-8" title="8"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> f))</a></code></pre></div>
<p><img src="forcats_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="randomly-shuffle-levels" class="section level3">
<h3><span class="header-section-number">6.4.6</span> Randomly shuffle levels</h3>
<p>The level of a factor can also be randomly shuffled using <code>fct_shuffle()</code>. The input argument can be either a factor or a character vector, whereas the output will be a factor. This is demonstrated using the factor <code>countries_in_1896</code>:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="co"># The original levels are sorted alphabetically.</span></a>
<a class="sourceLine" id="cb313-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb313-3" title="3"><span class="st">  </span><span class="kw">levels</span>() </a></code></pre></div>
<pre><code>##  [1] &quot;Australia&quot;     &quot;Austria&quot;       &quot;Denmark&quot;       &quot;France&quot;       
##  [5] &quot;Germany&quot;       &quot;Great Britain&quot; &quot;Greece&quot;        &quot;Hungary&quot;      
##  [9] &quot;Italy&quot;         &quot;Sweden&quot;        &quot;Switzerland&quot;   &quot;United States&quot;</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1"><span class="co"># The shuffled levels are randomly sorted.</span></a>
<a class="sourceLine" id="cb315-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb315-3" title="3"><span class="st">  </span><span class="kw">fct_shuffle</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb315-4" title="4"><span class="st">  </span><span class="kw">levels</span>()  </a></code></pre></div>
<pre><code>##  [1] &quot;Great Britain&quot; &quot;Germany&quot;       &quot;Sweden&quot;        &quot;Greece&quot;       
##  [5] &quot;Italy&quot;         &quot;France&quot;        &quot;Australia&quot;     &quot;Austria&quot;      
##  [9] &quot;Denmark&quot;       &quot;Hungary&quot;       &quot;United States&quot; &quot;Switzerland&quot;</code></pre>
</div>
<div id="reordering-levels-by-other-variables" class="section level3">
<h3><span class="header-section-number">6.4.7</span> Reordering levels by other variables</h3>
<p>The functions presented in this section bare great similarity to the <code>fct_relevel()</code> function introduced in the beginning of this chapter.
<code>fct_relevel()</code> allows a direct manipulation of the levels by passing the new order to the <code>levels</code> keyword argument. At this point <code>fct_reorder()</code> and <code>fct_reorder2()</code> are different. Here, the levels are reordered according to the result of a function applied to one vector <code>x</code> in case of <code>fct_reorder()</code> and two vectors <code>x</code> and <code>y</code> in case of <code>fct_reorder2()</code>.</p>
<dl>
<dt><strong>Note:</strong> We want to point out a few things that have to be kept in mind when using these functions.</dt>
<dd><ol style="list-style-type: decimal">
<li>The length of the factor <code>f</code> to be reordered has the be equal to the length of the vector(s) passed to the function.
There will occur an error, if <code>length(f) != length(x)</code> or <code>length(f) != length(y)</code>.</li>
<li>In case the function returns the same value for two different elements of the vector(s), R will arrange the levels automatically.</li>
<li>If there are multiple occurrences of an element, the level assigned to this element will be based on the result of the function for the first corresponding elements in <code>x</code> (and <code>y</code>).</li>
</ol>
</dd>
</dl>
<p>The example below is intended to unravel this behavior for <code>fct_reorder()</code>. We count the occurrences of countries in the <code>olympic_1896</code> dataset and create a factor where the levels are sorted based on the number of occurrences.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1">disciplines_per_country_in_<span class="dv">1896</span> &lt;-<span class="st"> </span>olympic_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb317-2" title="2"><span class="st">  </span><span class="kw">count</span>(country)</a>
<a class="sourceLine" id="cb317-3" title="3"></a>
<a class="sourceLine" id="cb317-4" title="4"><span class="co"># Reorder the countries according to the number of disciplines.</span></a>
<a class="sourceLine" id="cb317-5" title="5">disciplines_per_country_in_<span class="dv">1896</span><span class="op">$</span>country <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-6" title="6"><span class="st">  </span><span class="kw">fct_reorder</span>(disciplines_per_country_in_<span class="dv">1896</span><span class="op">$</span>n, <span class="dt">.desc =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] Australia     Austria       Denmark       France        Germany      
##  [6] Great Britain Greece        Hungary       Italy         Sweden       
## [11] Switzerland   United States
## 12 Levels: Greece Germany United States France Great Britain ... Italy</code></pre>
</div>
</div>
<div id="change-the-value-of-levels" class="section level2">
<h2><span class="header-section-number">6.5</span> Change the value of levels</h2>
<div id="renaming-the-levels" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Renaming the levels</h3>
<p>Let’s say you want to change the name of the levels (which also implies changing the corresponding value elements). <code>fct_recode()</code> allows to manually assign new names to certain levels without affecting the order of the levels or having an impact on levels that are not included in the function call.
The <code>diamonds$clarity</code> column is an ideal example for the use of <code>fct_recode()</code>. For you conviniece we repeat some of the steps made in the beginning of this chapter:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1"><span class="co"># Define the correct order of the levels in ascending order.</span></a>
<a class="sourceLine" id="cb319-2" title="2">levels_clarity &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;I1&quot;</span>, <span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;VS2&quot;</span>, <span class="st">&quot;VS1&quot;</span>, <span class="st">&quot;VVS2&quot;</span>, <span class="st">&quot;VVS1&quot;</span>, <span class="st">&quot;IF&quot;</span>)</a>
<a class="sourceLine" id="cb319-3" title="3"><span class="co"># Make `diamonds$clarity` a factor and assign the correctly ordered levels.</span></a>
<a class="sourceLine" id="cb319-4" title="4">factor_clarity &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> diamonds<span class="op">$</span>clarity, <span class="dt">levels =</span> levels_clarity)</a>
<a class="sourceLine" id="cb319-5" title="5"></a>
<a class="sourceLine" id="cb319-6" title="6"><span class="co"># Since the level notation is somewhat cryptic, we want to change it.</span></a>
<a class="sourceLine" id="cb319-7" title="7">renamed_factor_clarity &lt;-<span class="st"> </span>factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb319-8" title="8"><span class="st">  </span><span class="kw">fct_recode</span>(<span class="st">`</span><span class="dt">Included 1 (worst)</span><span class="st">`</span>=<span class="st">&quot;I1&quot;</span>,</a>
<a class="sourceLine" id="cb319-9" title="9">             <span class="st">`</span><span class="dt">Slightly Included 2</span><span class="st">`</span>=<span class="st">&quot;SI2&quot;</span>,</a>
<a class="sourceLine" id="cb319-10" title="10">             <span class="st">`</span><span class="dt">Slightly Included 1</span><span class="st">`</span>=<span class="st">&quot;SI1&quot;</span>,</a>
<a class="sourceLine" id="cb319-11" title="11">             <span class="st">`</span><span class="dt">Very Slightly Included 2</span><span class="st">`</span>=<span class="st">&quot;VS2&quot;</span>,</a>
<a class="sourceLine" id="cb319-12" title="12">             <span class="st">`</span><span class="dt">Very Slightly Included 1</span><span class="st">`</span>=<span class="st">&quot;VS1&quot;</span>,</a>
<a class="sourceLine" id="cb319-13" title="13">             <span class="st">`</span><span class="dt">Very Very Slightly Included 2</span><span class="st">`</span>=<span class="st">&quot;VVS2&quot;</span>,</a>
<a class="sourceLine" id="cb319-14" title="14">             <span class="st">`</span><span class="dt">Very Very Slightly Included 1</span><span class="st">`</span>=<span class="st">&quot;VVS1&quot;</span>,</a>
<a class="sourceLine" id="cb319-15" title="15">             <span class="st">`</span><span class="dt">Internally Flawless (best)</span><span class="st">`</span>=<span class="st">&quot;IF&quot;</span>)</a>
<a class="sourceLine" id="cb319-16" title="16"></a>
<a class="sourceLine" id="cb319-17" title="17"><span class="co"># Show the renamed levels.</span></a>
<a class="sourceLine" id="cb319-18" title="18">renamed_factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb319-19" title="19"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Included 1 (worst)&quot;            &quot;Slightly Included 2&quot;          
## [3] &quot;Slightly Included 1&quot;           &quot;Very Slightly Included 2&quot;     
## [5] &quot;Very Slightly Included 1&quot;      &quot;Very Very Slightly Included 2&quot;
## [7] &quot;Very Very Slightly Included 1&quot; &quot;Internally Flawless (best)&quot;</code></pre>
<p>Note, that this approach is in fact similar to the steps described in <a href="forcats.html#Inspect-and-set-levels">5.2.3 Inspect and set levels</a>.</p>
<p><a name="recode-2"></a>One could also combine multiple levels into one using <code>fct_recode()</code> as shown in the example below, where the numerical distinction within the GIA categories is dropped, that is <em>Slightly Included 2</em> and <em>Slightly Included 1</em> will be combined into the level <em>Slightly Included</em>, etc.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1"><span class="co"># Since the level notation is somewhat cryptic, we want to change it</span></a>
<a class="sourceLine" id="cb321-2" title="2"><span class="co"># and drop the numerical distinction within each category.</span></a>
<a class="sourceLine" id="cb321-3" title="3">renamed_factor_clarity_<span class="dv">2</span> &lt;-<span class="st"> </span>factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb321-4" title="4"><span class="st">  </span><span class="kw">fct_recode</span>(<span class="st">`</span><span class="dt">Included (worst)</span><span class="st">`</span>=<span class="st">&quot;I1&quot;</span>,</a>
<a class="sourceLine" id="cb321-5" title="5">             <span class="st">`</span><span class="dt">Slightly Included</span><span class="st">`</span>=<span class="st">&quot;SI2&quot;</span>,</a>
<a class="sourceLine" id="cb321-6" title="6">             <span class="st">`</span><span class="dt">Slightly Included</span><span class="st">`</span>=<span class="st">&quot;SI1&quot;</span>,</a>
<a class="sourceLine" id="cb321-7" title="7">             <span class="st">`</span><span class="dt">Very Slightly Included</span><span class="st">`</span>=<span class="st">&quot;VS2&quot;</span>,</a>
<a class="sourceLine" id="cb321-8" title="8">             <span class="st">`</span><span class="dt">Very Slightly Included</span><span class="st">`</span>=<span class="st">&quot;VS1&quot;</span>,</a>
<a class="sourceLine" id="cb321-9" title="9">             <span class="st">`</span><span class="dt">Very Very Slightly Included</span><span class="st">`</span>=<span class="st">&quot;VVS2&quot;</span>,</a>
<a class="sourceLine" id="cb321-10" title="10">             <span class="st">`</span><span class="dt">Very Very Slightly Included</span><span class="st">`</span>=<span class="st">&quot;VVS1&quot;</span>,</a>
<a class="sourceLine" id="cb321-11" title="11">             <span class="st">`</span><span class="dt">Internally Flawless (best)</span><span class="st">`</span>=<span class="st">&quot;IF&quot;</span>)</a>
<a class="sourceLine" id="cb321-12" title="12"></a>
<a class="sourceLine" id="cb321-13" title="13"><span class="co"># Show the combined levels.</span></a>
<a class="sourceLine" id="cb321-14" title="14">renamed_factor_clarity_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb321-15" title="15"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Included (worst)&quot;            &quot;Slightly Included&quot;          
## [3] &quot;Very Slightly Included&quot;      &quot;Very Very Slightly Included&quot;
## [5] &quot;Internally Flawless (best)&quot;</code></pre>
<p>The resulting <code>renamed_factor_clarity_2</code> now has only five distinct levels as compared to eight distinct levels in <code>renamed_factor_clarity</code>.</p>
<p>Another scenario might be that we want to add either a pre- or a suffix or both to the current level or change the levels in some other general manner. To this end, the forcats package provides the <code>fct_relabel()</code> function. Its second argument (or its first argument in case of piping) is a function that must return a character vector. The <code>countries_in_1896</code> factor variable is used to showcase how <code>fct_relabel()</code> works.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1">add_prefix &lt;-<span class="st"> </span><span class="cf">function</span>(input_char) {</a>
<a class="sourceLine" id="cb323-2" title="2">  <span class="kw">paste</span>(<span class="st">&quot;Country:&quot;</span>, input_char)</a>
<a class="sourceLine" id="cb323-3" title="3">}</a>
<a class="sourceLine" id="cb323-4" title="4"><span class="co"># The `add_prefix()` function is applied to each level </span></a>
<a class="sourceLine" id="cb323-5" title="5"><span class="co"># returning a character vector of the new labels. </span></a>
<a class="sourceLine" id="cb323-6" title="6">prefixed_countries_in_<span class="dv">1896</span> &lt;-<span class="st"> </span>countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb323-7" title="7"><span class="st">  </span><span class="kw">fct_relabel</span>(add_prefix)</a>
<a class="sourceLine" id="cb323-8" title="8"></a>
<a class="sourceLine" id="cb323-9" title="9"><span class="co"># Show the combined levels.</span></a>
<a class="sourceLine" id="cb323-10" title="10">prefixed_countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb323-11" title="11"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;Country: Australia&quot;     &quot;Country: Austria&quot;       &quot;Country: Denmark&quot;      
##  [4] &quot;Country: France&quot;        &quot;Country: Germany&quot;       &quot;Country: Great Britain&quot;
##  [7] &quot;Country: Greece&quot;        &quot;Country: Hungary&quot;       &quot;Country: Italy&quot;        
## [10] &quot;Country: Sweden&quot;        &quot;Country: Switzerland&quot;   &quot;Country: United States&quot;</code></pre>
</div>
<div id="anonymize-levels" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Anonymize levels</h3>
<p>There might be situations, especially in the context of data privacy, where you want or need to anonymize your factor data. Assigning numeric IDs using <code>fct_anon()</code> is a good way to do this. It randomly assigns integer values (converted to characters) starting from <code>1</code> to the levels of a factor variable. The largest integer value to be assigned depends on the number of distinct levels in the variable. In the following example the <code>countries_in_1896</code> factor variable with 12 distinct levels is randomly anonymized.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1"><span class="co"># The function `fct_anon()` additionally allows to</span></a>
<a class="sourceLine" id="cb325-2" title="2"><span class="co"># define a prefix for the new random integer levels.</span></a>
<a class="sourceLine" id="cb325-3" title="3">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-4" title="4"><span class="st">  </span><span class="kw">fct_anon</span>(<span class="dt">prefix=</span><span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-5" title="5"><span class="st">  </span><span class="kw">head</span>(<span class="dv">25</span>)</a></code></pre></div>
<pre><code>##  [1] id09 id09 id09 id09 id09 id09 id09 id09 id09 id09 id04 id04 id04 id10 id09
## [16] id02 id02 id05 id05 id05 id05 id05 id05 id05 id04
## Levels: id01 id02 id03 id04 id05 id06 id07 id08 id09 id10 id11 id12</code></pre>
</div>
<div id="collapse-multiple-levels-into-one" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Collapse multiple levels into one</h3>
<p>The <code>fct_collapse()</code> function provides basically the same functionality as displayed in the <a href="#recode-2">2nd example for <code>fct_recode()</code></a>.
The syntax however is slightly different as the levels to be combined are specified in a single vector as shown in the example below.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1">renamed_factor_clarity_<span class="dv">3</span> &lt;-<span class="st"> </span>factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb327-2" title="2"><span class="st">  </span><span class="kw">fct_collapse</span>(<span class="st">`</span><span class="dt">Included (worst)</span><span class="st">`</span>=<span class="st">&quot;I1&quot;</span>,</a>
<a class="sourceLine" id="cb327-3" title="3">               <span class="st">`</span><span class="dt">Slightly Included</span><span class="st">`</span>=<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>),</a>
<a class="sourceLine" id="cb327-4" title="4">               <span class="st">`</span><span class="dt">Very Slightly Included</span><span class="st">`</span>=<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VS2&quot;</span>,<span class="st">&quot;VS1&quot;</span>),</a>
<a class="sourceLine" id="cb327-5" title="5">               <span class="st">`</span><span class="dt">Very Very Slightly Included</span><span class="st">`</span>=<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VVS2&quot;</span>, <span class="st">&quot;VVS1&quot;</span>),</a>
<a class="sourceLine" id="cb327-6" title="6">               <span class="st">`</span><span class="dt">Internally Flawless (best)</span><span class="st">`</span>=<span class="st">&quot;IF&quot;</span>)</a></code></pre></div>
<p>It should be noted, that <code>fct_recode()</code> could be easily replaced with <code>fct_collapse()</code> in the <a href="#recode-2">2nd example for <code>fct_recode()</code></a> as <code>fct_collapse()</code> also works with single element character vectors. Replacing <code>fct_collapse()</code> with <code>fct_recode()</code> on the other hand is not possible, because <code>fct_recode()</code> cannot work with multiple element vectors such as <code>c("SI2", "SI1")</code>. In this case, we recommend using <code>fct_collapse()</code> than <code>fct_recode()</code> for combining different levels.</p>
</div>
<div id="aggregate-levels-into-a-lump" class="section level3">
<h3><span class="header-section-number">6.5.4</span> Aggregate levels into a lump</h3>
<p>This topic is related to the rationale behind <code>fct_collapse()</code> described in the previous section. In contrast to specifying the levels to be combined explicitly, the forcats package also offers the possibility to lump levels together. “Lumping” is the act of combining several levels in order to create a single lump level called <code>Other</code> by default. There are several different functions that allow lumping based on different criteria.<br />
The functions which is probably easiest to understand is <code>fct_lump_n()</code> which takes an integer value <code>n</code> as the second (or the first argument in case of piping).
It allows to preserve the <code>n</code> most/least frequent levels for <code>n&gt;0</code> / <code>n&lt;0</code>. All other levels will be lumped together into one level that has the lowest order and is referred to as <code>Other</code> by default.
Once again, we use data from the Summer Olympic Games in 1896 to give an example.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="co"># Only keep the three most frequent countries </span></a>
<a class="sourceLine" id="cb328-2" title="2"><span class="co"># and lump all other countries into `Other`.</span></a>
<a class="sourceLine" id="cb328-3" title="3">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-4" title="4"><span class="st">  </span><span class="kw">fct_lump_n</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-5" title="5"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Germany&quot;       &quot;Greece&quot;        &quot;United States&quot; &quot;Other&quot;</code></pre>
<p>We just discovered that Germany was one of the countries competing in the most disciplines during the Summer Olympic Games 1896 although quite laboriously.
Note, that we can however not conclude that most disciplines were competed by German athletes in 1896 as the levels are ordered alphabetically (except for <code>Other</code> which will always be last) and not by the number of disciplines per country. In fact, with 148 disciplines competed by Greek athletes, 94 by German and 27 by athletes from the US, Germany ranks second.</p>
<p>To continue, we assume to be only interested in the countries whose athletes competed in at least 10 disciplines in the Summer Olympic Games 1896.
For that purpose we use the <code>fct_lump_min()</code> function specifying the minimum of 10.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1"><span class="co"># Only keep the countries whose athletes competed in at least 10 disciplines </span></a>
<a class="sourceLine" id="cb330-2" title="2"><span class="co"># and lump all other countries.</span></a>
<a class="sourceLine" id="cb330-3" title="3">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb330-4" title="4"><span class="st">  </span><span class="kw">fct_lump_min</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb330-5" title="5"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Denmark&quot;       &quot;France&quot;        &quot;Germany&quot;       &quot;Great Britain&quot;
## [5] &quot;Greece&quot;        &quot;Hungary&quot;       &quot;United States&quot; &quot;Other&quot;</code></pre>
<p>Now we know that there were only eight countries whose athletes competed in 10 disciplines or more.</p>
<p>We could also be interested in relative rather than absolute number, say countries that provide at least a 10% share of the total number of disciplines. In 1896 there was a total number of 38 disciplines to compete in. To identify the desired set of countries, we lump proportionally using <code>fcr_lump_prop()</code>.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="co"># Only keep the countries whose athletes add up to </span></a>
<a class="sourceLine" id="cb332-2" title="2"><span class="co"># at least 10% of all competition records</span></a>
<a class="sourceLine" id="cb332-3" title="3"><span class="co"># and lump all other countries.</span></a>
<a class="sourceLine" id="cb332-4" title="4">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb332-5" title="5"><span class="st">  </span><span class="kw">fct_lump_prop</span>(<span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb332-6" title="6"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Germany&quot; &quot;Greece&quot;  &quot;Other&quot;</code></pre>
</div>
<div id="manually-lump-levels" class="section level3">
<h3><span class="header-section-number">6.5.5</span> Manually lump levels</h3>
<p>In the previous section, we combined levels into a lump called <code>Other</code> based on numerical criteria. In addition to this, we can also create our own lump using <code>fct_other()</code>.In this function, we specify the levels we want to keep or drop as a vector to the <code>keep</code> or <code>drop</code> keyword argument.
The following code demonstrates how to only keep the levels <code>Denmark</code> and <code>Australia</code> in the <code>countries_in_1896</code> factor variable.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1"><span class="co"># Only keep the levels `Denmark` and `Australia`.</span></a>
<a class="sourceLine" id="cb334-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb334-3" title="3"><span class="st">  </span><span class="kw">fct_other</span>(<span class="dt">keep=</span><span class="kw">c</span>(<span class="st">&quot;Denmark&quot;</span>, <span class="st">&quot;Australia&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb334-4" title="4"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Australia&quot; &quot;Denmark&quot;   &quot;Other&quot;</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1"><span class="co"># Keep all levels except for `Denmark` and `Australia`.</span></a>
<a class="sourceLine" id="cb336-2" title="2">countries_in_<span class="dv">1896</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb336-3" title="3"><span class="st">  </span><span class="kw">fct_other</span>(<span class="dt">drop=</span><span class="kw">c</span>(<span class="st">&quot;Denmark&quot;</span>, <span class="st">&quot;Australia&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb336-4" title="4"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;Austria&quot;       &quot;France&quot;        &quot;Germany&quot;       &quot;Great Britain&quot;
##  [5] &quot;Greece&quot;        &quot;Hungary&quot;       &quot;Italy&quot;         &quot;Sweden&quot;       
##  [9] &quot;Switzerland&quot;   &quot;United States&quot; &quot;Other&quot;</code></pre>
<p>Note that the latter example is equivalent to using <code>fct_collapse(Other=c("Denmark", "Australia"))</code>.</p>
</div>
</div>
<div id="add-or-drop-levels" class="section level2">
<h2><span class="header-section-number">6.6</span> Add or drop levels</h2>
<div id="add-levels" class="section level3">
<h3><span class="header-section-number">6.6.1</span> Add levels</h3>
<p>In order to add levels to a factor variable we can use the <code>fct_expand()</code> function, which takes the level as an argument. For a more accurate demonstration, we switch to the <code>diamonds</code> dataset one more time as we want to use all GIA grades as levels now.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1"><span class="co"># The additional GIA grades which do not exist in the diamonds dataset.</span></a>
<a class="sourceLine" id="cb338-2" title="2">additional_GIA_grades &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>, <span class="st">&quot;I2&quot;</span>, <span class="st">&quot;I3&quot;</span>)</a>
<a class="sourceLine" id="cb338-3" title="3"></a>
<a class="sourceLine" id="cb338-4" title="4"><span class="co"># Expand the original factor by the additional levels.</span></a>
<a class="sourceLine" id="cb338-5" title="5">expanded_factor_clarity &lt;-<span class="st"> </span>factor_clarity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb338-6" title="6"><span class="st">  </span><span class="kw">fct_expand</span>(additional_GIA_grades)</a>
<a class="sourceLine" id="cb338-7" title="7"></a>
<a class="sourceLine" id="cb338-8" title="8"><span class="co"># Note that the new levels are appended.</span></a>
<a class="sourceLine" id="cb338-9" title="9">expanded_factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb338-10" title="10"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;I1&quot;   &quot;SI2&quot;  &quot;SI1&quot;  &quot;VS2&quot;  &quot;VS1&quot;  &quot;VVS2&quot; &quot;VVS1&quot; &quot;IF&quot;   &quot;FL&quot;   &quot;I2&quot;  
## [11] &quot;I3&quot;</code></pre>
<p>Note that the additional levels get appended which is not necessarily what we want. Thus, an additional manual reordering of the levels as described in <a href="forcats.html#manual-reordering">5.4.1 Manual reordering of levels</a> is required here:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1"><span class="co"># All GIA grades in the correct order.</span></a>
<a class="sourceLine" id="cb340-2" title="2">all_GIA_grades &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>, <span class="st">&quot;IF&quot;</span>, <span class="st">&quot;VVS1&quot;</span>, <span class="st">&quot;VVS2&quot;</span>, <span class="st">&quot;VS1&quot;</span>, <span class="st">&quot;VS2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;I1&quot;</span>, <span class="st">&quot;I2&quot;</span>, <span class="st">&quot;I3&quot;</span>)</a>
<a class="sourceLine" id="cb340-3" title="3"></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="co"># Reorder the levels of the expanded factor.</span></a>
<a class="sourceLine" id="cb340-5" title="5">reordered_expanded_factor_clarity &lt;-<span class="st"> </span>expanded_factor_clarity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb340-6" title="6"><span class="st">  </span><span class="kw">fct_relevel</span>(all_GIA_grades) </a>
<a class="sourceLine" id="cb340-7" title="7"></a>
<a class="sourceLine" id="cb340-8" title="8">reordered_expanded_factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb340-9" title="9"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;FL&quot;   &quot;IF&quot;   &quot;VVS1&quot; &quot;VVS2&quot; &quot;VS1&quot;  &quot;VS2&quot;  &quot;SI1&quot;  &quot;SI2&quot;  &quot;I1&quot;   &quot;I2&quot;  
## [11] &quot;I3&quot;</code></pre>
<p>A less tedious approach would be to include the additional levels already in the definition of the factor variable using <code>factor()</code> as shown in the following.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1"><span class="kw">factor</span>(<span class="dt">x =</span> diamonds<span class="op">$</span>clarity, <span class="dt">levels=</span>all_GIA_grades) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb342-2" title="2"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;FL&quot;   &quot;IF&quot;   &quot;VVS1&quot; &quot;VVS2&quot; &quot;VS1&quot;  &quot;VS2&quot;  &quot;SI1&quot;  &quot;SI2&quot;  &quot;I1&quot;   &quot;I2&quot;  
## [11] &quot;I3&quot;</code></pre>
</div>
<div id="drop-levels" class="section level3">
<h3><span class="header-section-number">6.6.2</span> Drop levels</h3>
<p>Unfortunately, we haven’t found any flawless diamond, so the level <code>FL</code> unused. To drop unused levels, the forcats package provides a function called <code>fct_drop()</code>.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1"><span class="co"># Only drop the unused &quot;FL&quot; level.</span></a>
<a class="sourceLine" id="cb344-2" title="2">reordered_expanded_factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb344-3" title="3"><span class="st">  </span><span class="kw">fct_drop</span>(<span class="st">&quot;FL&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb344-4" title="4"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;IF&quot;   &quot;VVS1&quot; &quot;VVS2&quot; &quot;VS1&quot;  &quot;VS2&quot;  &quot;SI1&quot;  &quot;SI2&quot;  &quot;I1&quot;   &quot;I2&quot;   &quot;I3&quot;</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1"><span class="co"># Drop all unused levels when no argument is used.</span></a>
<a class="sourceLine" id="cb346-2" title="2">reordered_expanded_factor_clarity <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb346-3" title="3"><span class="st">  </span><span class="kw">fct_drop</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb346-4" title="4"><span class="st">  </span><span class="kw">levels</span>()</a></code></pre></div>
<pre><code>## [1] &quot;IF&quot;   &quot;VVS1&quot; &quot;VVS2&quot; &quot;VS1&quot;  &quot;VS2&quot;  &quot;SI1&quot;  &quot;SI2&quot;  &quot;I1&quot;</code></pre>
</div>
<div id="assign-a-level-to-nas" class="section level3">
<h3><span class="header-section-number">6.6.3</span> Assign a level to <code>NAs</code></h3>
<p>Usually when a vector contains <code>NAs</code> they are omitted in the conversion to a factor variable. The forcats package allows to explicitly assign a level to these values using the <code>fct_explicit_na()</code> function. To give an example, we return to the <code>olympic_1896</code> dataset but we focus on the <code>city</code> column this time.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1"><span class="co"># Convert the `medal` column into a factor.</span></a>
<a class="sourceLine" id="cb348-2" title="2">olympic_<span class="dv">1896</span><span class="op">$</span>medal <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb348-3" title="3"><span class="st">  </span><span class="kw">factor</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb348-4" title="4"><span class="st">  </span><span class="kw">fct_count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   f          n
##   &lt;fct&gt;  &lt;int&gt;
## 1 Bronze    38
## 2 Gold      62
## 3 Silver    43
## 4 &lt;NA&gt;     237</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="co"># Convert the `medal` column into a factor, replacing the NA values.</span></a>
<a class="sourceLine" id="cb350-2" title="2">olympic_<span class="dv">1896</span><span class="op">$</span>medal <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-3" title="3"><span class="st">  </span><span class="kw">fct_explicit_na</span>(<span class="st">&quot;No medal&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-4" title="4"><span class="st">  </span><span class="kw">fct_count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   f            n
##   &lt;fct&gt;    &lt;int&gt;
## 1 Bronze      38
## 2 Gold        62
## 3 Silver      43
## 4 No medal   237</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lubridate.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stringr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tillschwoerer/R-data-science-book/blob/master/forcats.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
